{
  "rules": {
    "admins": {
      ".read": "false",  // Only a cloud function or admins can update this.
      ".write": "false",  // Only a cloud function or admins can update this.
      "$index": {
        "email": {
          ".validate": "newData.isString()"
        }
      }
    },
    // Public profile information.
    "login": {
      ".indexOn": ["_search_index/full_name", "_search_index/reversed_full_name", "uid"],
      "$uid": {
        ".read": "auth.uid === $uid || auth.token.admin === true",
        ".write": "auth.uid === $uid || auth.token.admin === true",
        // Termo  de serviço settings
        "termo_servico": {
          "aprovado": {
            ".validate": "newData.isBoolean()"
          }
        }
      }      
    },
    "settings" : {
      // estrutura básica da home
      "home": {
        ".read": "auth.uid !== null || auth.token.admin === true",
        ".write": "false"
      },    
      // segmentos de clientes
      "segmentos": {
        ".read": "auth.uid !== null || auth.token.admin === true",
        ".write": "false"
      },
      "primeiro_login": {
        "lista_email_valido": {
          ".indexOn": "email",
          ".read": "auth.uid !== null || auth.token.admin === true",
          ".write": "false"
        },
        "lista_celular_valido": {
          ".indexOn": "celular",
          ".read": "auth.uid !== null || auth.token.admin === true",
          ".write": "false"
        }            
      }
    },
    // dados do usuário
    "usuarios": {
      ".read": "auth.token.admin === true",
      ".write": "false",
      "$chave": {
        ".read": "root.child('login/'+auth.uid+'/lista_chaves/'+$chave).val() >= 0",
        ".write": "root.child('login/'+auth.uid+'/lista_chaves/'+$chave).val() >= 0"
      }
    },
    "usuariosHistorico": {
      ".read": "auth.token.admin === true",
      ".write": "false"
    },    
    // Disallow all other attributes.
    "$other": {
      ".validate": false
    }
  }
}
